\section{Metodología de evaluación}

\subsection{Entorno de ejecución} \label{subsec:entorno}
 Aunque la máquina dispone de una GPU \textit{ NVIDIA GeForce RTX 4060 (8~GB VRAM)}, no se empleó aceleración por GPU debido a incompatibilidades prácticas entre el entorno Windows y las dependencias (versionado de CUDA/cuDNN y librerías) requeridas. En consecuencia, la totalidad de los entrenamientos se ejecutó en \textbf{CPU}. Esta decisión afecta al coste temporal de entrenamiento, pero no altera la lógica de los algoritmos ni los hiperparámetros establecidos.

\subsection{Métricas de calidad}
La tarea se evalúa como detección binaria de anomalías (clase positiva: \(\texttt{label} = 1\)). Se reportan métricas por capa (B y C) cuando aplica, y una métrica principal \textbf{best\_f1} definida como \(\max(\text{F1}_B, \text{F1}_C)\) en el modelo híbrido.

Definiciones:
\begin{itemize}
    \item Precisión: \(\mathrm{Prec} = \frac{TP}{TP + FP}\).
    \item Recall: \(\mathrm{Rec} = \frac{TP}{TP + FN}\).
    \item F1-score: \(\mathrm{F1} = \frac{2 \cdot \mathrm{Prec} \cdot \mathrm{Rec}}{\mathrm{Prec} + \mathrm{Rec}}\).
\end{itemize}

Adicionalmente:
\begin{itemize}
    \item \textbf{MSE} por capa (B y C) sobre la señal procesada.
    \item \textbf{Matriz de confusión} y curvas PR/ROC por dataset y modelo.
    \item \textbf{Latencia de detección} (opcional): tiempo desde inicio del evento hasta primera detección.
\end{itemize}

\subsection{Métricas de eficiencia}
Se cuantifican:
\begin{itemize}
    \item \textbf{Tiempo de entrenamiento}: por \textit{trial} y total del estudio (según \texttt{start\_time/end\_time} y \texttt{duration\_seconds}).
    \item \textbf{Tiempo de inferencia}: medio y desviación por ventana de longitud \(T=250\) y por segundo de señal.
    \item \textbf{Uso de memoria}: pico de RAM/VRAM (si disponible).
\end{itemize}

\subsection{Protocolo de validación}
\begin{itemize}
    \item Particionado temporal 50/50 (sin mezcla) para cada dataset.
    \item Optimización de hiperparámetros con Optuna sobre el conjunto de entrenamiento; evaluación en prueba. 
    \item En todas las configuraciones se utilizó selección basada en validación sobre el conjunto de entrenamiento, evitando contaminación con el conjunto de prueba.
    \item Semillas pseudoaleatorias: Se emplearon semillas fijas por trial para garantizar reproducibilidad, con un único experimento por configuración de red (sin promediado de corridas múltiples debido a restricciones temporales).
\end{itemize}
